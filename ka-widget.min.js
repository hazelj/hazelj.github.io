var BASE_API_URL='https://og2020-api.sports.gracenote.com/svc/games_v2.svc/json/GetSchedulePerson'
var ENV="RELEASE"
var EMPTY_SCHOOL_STR="None Listed";var RESULTS_MODE='results_mode';var LEADER_MODE='leader_mode';var MAX_COL_CHARS=20;var ATHLETE_ID_COL=0;var SCHOOL_1_COL=1;var SCHOOL_2_COL=2
var GOLD_COL='b_Gold';var SILV_COL='b_Silver';var BROZ_COL='b_Bronze';var kaAllResultsByDate={};var kaAllResultsBySchool={};var kaAllSports=new Set();var kaAllSchools=new Set();ANIMATION_SPEED=300;var icon_lookup={"Archery":"1_Archery_uncropped.png","Athletics":"1_TrackField_uncropped.png","BMX":"1_BMX_uncropped.png","Badminton":"1_Badminton_uncropped.png","Basketball":"1_Basketball_uncropped.png","Beach Volleyball":"1_BeachVolleyball_uncropped.png","Boxing":"1_Boxing_uncropped.png","Canoe Slalom":"1_Canoe&Kayak_uncropped.png","Canoe Sprint":"1_Canoe&Kayak_uncropped.png","Cycling - Road":"1_Cycling_uncropped.png","Cycling - Track":"1_Cycling_uncropped.png","Diving":"1_Diving_uncropped.png","Equestrian - Dressage":"1_Equestrian_D_uncropped.png","Equestrian - Eventing":"1_Equestrian_E_uncropped.png","Equestrian - Jumping":"1_Equestrian_SJ_uncropped.png","Fencing":"1_Fencing_uncropped.png","Football":"1_Soccer_uncropped.png","Golf":"1_Golf_uncropped.png","Gymnastics - Artistic":"1_ArtisticGymnastics_uncropped.png","Gymnastics - Rhythmic":"1_RhythmicGymnastics_uncropped.png","Gymnastics - Trampolining":"1_Trampoline_uncropped.png","Hockey":"1_FieldHockey_uncropped.png","Judo":"1_Judo_uncropped.png","Modern Pentathlon":"1_Pentathlon_uncropped.png","Mountain Bike":"1_Cycling_uncropped.png","Open Water Swimming":"1_Swimming_uncropped.png","Rowing":"1_Rowing_uncropped.png","Rugby Sevens":"1_Rugby_uncropped.png","Sailing":"1_Sailing_uncropped.png","Shooting":"1_Shooting_uncropped.png","Swimming":"1_Swimming_uncropped.png","Synchronised Swimming":"1_SyncSwimming_uncropped.png","Table Tennis":"1_TableTennis_uncropped.png","Taekwondo":"1_Taekwondo_uncropped.png","Tennis":"1_Tennis_uncropped.png","Triathlon":"1_Triathlon_uncropped.png","Volleyball":"1_Volleyball_uncropped.png","Water Polo":"1_WaterPolo_uncropped.png","Weightlifting":"1_Weightlifting_uncropped.png","Wrestling - Freestyle":"1_Wrestling_uncropped.png","Wrestling - Greco-Roman":"1_Wrestling_uncropped.png"};var athlete_lookup=[[652281,"",""],[678315,"",""],[1045452,"",""],[1316631,"",""],[1181876,"Dartmouth College",""],[878893,"Temple University",""],[465701,"University of Southern California",""],[588451,"Coastal Carolina University",""],[1165845,"Texas A&M University--College Station",""],[1269190,"",""],[878909,"University of Kansas",""],[878901,"University of Kentucky",""],[952290,"University of Florida",""],[1075222,"University of Illinois--Urbana-Champaign","University of Texas--Austin"],[740595,"University of Oregon",""],[945452,"University of California--Santa Barbara",""],[1073516,"Cornell University",""],[251457,"Washington State University",""],[1386487,"Adams State University",""],[1277171,"Texas Tech University",""],[1022057,"University of California--Riverside",""],[1075758,"Clemson University",""],[1069565,"",""],[680987,"University of Mississippi",""],[1324864,"University of Texas--Austin",""],[1181719,"United States Air Force Academy",""],[943773,"University of California--Berkeley",""],[561401,"Georgia Institute of Technology",""],[1181722,"Arizona State University",""],[1357778,"University of Arkansas",""],[1354667,"University of Tennessee",""],[740198,"University of Florida",""],[1277212,"Coppin State University",""],[1354774,"University of Akron",""],[1337129,"Florida State University",""],[741110,"",""],[1074397,"University of New Mexico",""],[1200471,"University of Texas--Austin",""],[798039,"University of Oregon",""],[1079930,"University of Southern California",""],[1277199,"Pennsylvania State University--University Park",""],[879362,"George Mason University",""],[1434588,"University of Oregon",""],[1076297,"Southern Illinois University--Carbondale",""],[750913,"Arizona State University",""],[1277207,"University of Oregon",""],[853392,"University of Oklahoma",""],[1158151,"Georgetown University",""],[943757,"University of Colorado--Boulder",""],[978691,"University of Oregon",""],[943760,"Kansas State University",""],[740889,"University of Wisconsin--Madison",""],[1181924,"Indiana State University",""],[798078,"Hampton University",""],[680588,"University of Oregon",""],[789317,"Texas Tech University",""],[1052325,"Southern Illinois University--Carbondale",""],[1178195,"University of Minnesota--Twin Cities",""],[940530,"St. Cloud State University",""],[1321916,"Iowa State University",""],[685449,"University of California--Berkeley",""],[725661,"Arizona State University",""],[1183637,"Brigham Young University--Provo",""],[1074455,"University of Arkansas",""],[839838,"Stillman College",""],[740469,"University of Michigan--Ann Arbor",""],[1183672,"University of Oregon",""],[970390,"Northern Michigan University",""],[680985,"University of Colorado--Boulder",""],[1183219,"University of Washington",""],[1071134,"Pennsylvania State University--University Park",""],[566116,"University of Wisconsin--Parkside",""],[458017,"University of Tennessee",""],[738667,"Purdue University--West Lafayette",""],[1176357,"Yale University",""],[1181949,"University of Wisconsin--Madison",""],[951272,"University of Georgia",""],[564450,"University of Florida",""],[1191563,"University of Georgia",""],[680968,"",""],[981125,"University of California--Berkeley",""],[902330,"Virginia Tech",""],[1181799,"University of Kansas",""],[565883,"East Carolina University",""],[1055540,"Iona College",""],[878183,"Harvard University",""],[1181807,"Texas State University",""],[1358261,"",""],[789405,"Long Island University",""],[1077847,"University of Texas--Austin",""],[879458,"Florida State University",""],[901841,"University of Wyoming",""],[654801,"University of Oregon",""],[295467,"University of California--Los Angeles",""],[620050,"Jackson State University",""],[588439,"University of Texas--Austin",""],[766787,"Florida International University",""],[655894,"Boston College",""],[1046881,"University of Wisconsin--Parkside",""],[691483,"University of Notre Dame",""],[1277336,"University of Texas--Austin",""],[549846,"University of South Carolina",""],[948654,"",""],[1183742,"University of Minnesota--Twin Cities",""],[1181992,"University of Oregon",""],[1294091,"University of Mississippi",""],[901825,"University of Mississippi",""],[878836,"University of Virginia",""],[863516,"",""],[952283,"Cornell University",""],[794527,"University of Texas--Austin",""],[1183511,"University of Mississippi",""],[986910,"Northern Michigan University",""],[1269811,"University of Arkansas",""],[789026,"Dartmouth College",""],[1354806,"Oklahoma State University",""],[566117,"University of North Carolina--Chapel Hill",""],[739315,"Duke University",""],[952717,"Texas A&M University--College Station",""],[1183711,"Arizona State University",""],[1357796,"",""],[1277310,"University of Tennessee",""],[1277350,"",""],[588441,"University of Tennessee",""],[943531,"University of Florida",""],[1165849,"University of Southern Mississippi",""],[1247484,"Baylor University",""],[559932,"University of Arkansas",""],[1343311,"",""],[1176352,"San Diego State University",""],[942970,"",""],[862641,"University of Wisconsin--Madison",""],[458745,"Irvine Valley College",""],[611869,"University of California--Los Angeles",""],[739456,"University of California--Los Angeles",""],[611884,"University of California--Los Angeles",""],[1381880,"Stanford University",""],[735700,"",""],[739258,"",""],[674323,"University of Louisville",""],[958020,"University of Connecticut",""],[1025574,"Baylor University",""],[488274,"Syracuse University",""],[711942,"Texas A&M University--College Station",""],[817745,"University of Southern California",""],[905412,"University of Kentucky",""],[558154,"University of Connecticut",""],[1105897,"Michigan State University",""],[1162176,"University of Delaware",""],[1105899,"University of North Carolina--Chapel Hill",""],[1011442,"Marquette University",""],[817827,"University of Texas--Austin",""],[794077,"Washington State University",""],[817782,"Villanova University",""],[1001241,"Duke University",""],[712115,"University of Minnesota--Twin Cities",""],[712160,"University of Connecticut",""],[905436,"California State University--Fresno",""],[690457,"Louisiana State University",""],[447561,"University of Connecticut",""],[728353,"Louisiana State University",""],[447563,"University of Tennessee",""],[898742,"University of Connecticut",""],[684414,"University of Southern California",""],[671586,"Florida Gulf Coast University",""],[926522,"Brigham Young University--Provo",""],[588610,"University of Utah",""],[1295267,"",""],[672014,"University of California--Los Angeles",""],[704757,"Florida State University",""],[1256510,"",""],[703998,"University of San Diego",""],[806911,"Marian University",""],[751183,"University of Nevada--Las Vegas",""],[766980,"",""],[1162413,"University of California--Los Angeles",""],[1414160,"",""],[903258,"University of Oklahoma",""],[1256517,"",""],[1046883,"",""],[1501494,"",""],[1046431,"Northern Michigan University",""],[664362,"",""],[1212671,"",""],[687119,"University of Maryland--College Park",""],[687088,"",""],[392774,"",""],[871212,"",""],[567745,"University of California--Santa Barbara",""],[429714,"Lees-McRae College",""],[801107,"Dartmouth College",""],[243013,"University of Idaho",""],[650636,"Whitman College",""],[763550,"Middlebury College",""],[686912,"",""],[1431539,"University of Iowa",""],[554035,"Penn State Lehigh Valley",""],[959747,"University of Colorado--Colorado Springs",""],[1188707,"University of Minnesota--Twin Cities",""],[1052320,"Princeton University",""],[403035,"Palomar College",""],[726474,"Duke University",""],[852461,"Indiana University--Bloomington",""],[583029,"Purdue University--West Lafayette",""],[850701,"Indiana University--Bloomington",""],[843964,"Stanford University",""],[1173845,"Florida State University",""],[723439,"Stanford University",""],[857239,"",""],[1046677,"University of Miami",""],[852473,"Purdue University--West Lafayette",""],[1367082,"",""],[1246681,"California State University--Sacramento",""],[1303318,"",""],[255996,"",""],[567481,"",""],[567495,"",""],[1180177,"",""],[255947,"",""],[679386,"University of Colorado--Colorado Springs",""],[547559,"",""],[941474,"Stanford University",""],[459125,"",""],[713671,"Stanford University",""],[596385,"University of Notre Dame",""],[558795,"St. John's University New York",""],[730884,"St. John's University New York",""],[1029941,"Harvard University",""],[651267,"University of Notre Dame",""],[717133,"Duke University",""],[790843,"Ohio State University--Columbus",""],[297170,"Southern Virginia University",""],[925324,"Princeton University",""],[468402,"University of Notre Dame",""],[790939,"University of Notre Dame",""],[319962,"University of Notre Dame",""],[716107,"Pennsylvania State University--University Park",""],[605057,"Stanford University",""],[679310,"Columbia University",""],[934066,"",""],[1417420,"Syracuse University",""],[1217355,"University of North Carolina--Chapel Hill",""],[803970,"University of North Carolina--Chapel Hill",""],[1046862,"University of Maryland--College Park",""],[803977,"Princeton University",""],[631728,"University of North Carolina--Chapel Hill",""],[1046681,"Princeton University",""],[682631,"University of Maryland--College Park",""],[766351,"Princeton University",""],[803985,"University of North Carolina--Chapel Hill",""],[631721,"Wake Forest University",""],[804018,"University of Connecticut",""],[680387,"Wake Forest University",""],[804021,"University of Virginia",""],[631710,"University of North Carolina--Chapel Hill",""],[1046880,"Duke University",""],[857457,"University of California--Berkeley",""],[728237,"Pennsylvania State University--University Park",""],[867176,"Pennsylvania State University--University Park",""],[682889,"Pennsylvania State University--University Park",""],[719074,"University of Virginia",""],[671603,"Rutgers","the State University of New Jersey--New Brunswick"],[1017520,"Stanford University",""],[857978,"University of North Carolina--Chapel Hill",""],[565324,"University of Washington",""],[707257,"University of Michigan--Ann Arbor",""],[682682,"Stanford University",""],[1128127,"",""],[1297756,"University of California--Los Angeles",""],[719115,"University of Portland",""],[682662,"University of North Carolina--Chapel Hill",""],[858007,"University of Virginia",""],[683262,"University of North Carolina--Chapel Hill",""],[963485,"University of North Carolina--Chapel Hill",""],[559024,"University of Georgia",""],[921947,"University of Texas--El Paso",""],[773618,"",""],[392263,"Georgia Institute of Technology",""],[907448,"",""],[726826,"Oklahoma State University",""],[738173,"University of Arkansas",""],[655526,"Princeton University",""],[854951,"",""],[794226,"Wake Forest University",""],[769774,"",""],[976049,"",""],[1025480,"",""],[816403,"University of Oklahoma",""],[1243996,"University of California--Los Angeles",""],[685315,"Colorado State University",""],[1148733,"University of California--Los Angeles",""],[1162110,"Loyola University Chicago",""],[1249795,"",""],[1307366,"",""],[1180306,"",""],[1162126,"University of Illinois--Urbana-Champaign",""],[1162127,"",""],[664522,"",""],[1275207,"",""],[616651,"Roberts Wesleyan College",""],[945483,"San Jose State University",""],[753391,"",""],[1089122,"University of Georgia",""],[1196721,"Dartmouth College",""],[685789,"North Shore Community College",""],[808263,"University of California--Los Angeles",""],[1084420,"Santa Clara University",""],[868311,"Eastern New Mexico University",""],[617224,"University of Arizona",""],[871658,"Fort Lewis College",""],[393283,"Middlebury College",""],[763088,"University of Southern California",""],[1086390,"Northwestern University",""],[740879,"University of Michigan--Ann Arbor",""],[799712,"University of Washington",""],[286763,"",""],[1073532,"Purdue University--West Lafayette",""],[744746,"University of Notre Dame",""],[1196675,"Brown University",""],[793947,"Princeton University",""],[807500,"Dartmouth College",""],[806378,"Stanford University",""],[577784,"Yale University",""],[800122,"Oregon State University",""],[874765,"United States Naval Academy",""],[697477,"University of Michigan--Ann Arbor",""],[354580,"Stanford University",""],[875580,"Michigan State University",""],[1216687,"Pepperdine University",""],[279487,"California Polytechnic State University--San Luis Obispo",""],[781733,"Princeton University",""],[1277058,"University of Wisconsin--Madison",""],[707256,"Stanford University",""],[1088337,"University of Washington",""],[577725,"Harvard University",""],[1246956,"",""],[655551,"University of Washington",""],[1343542,"University of Arkansas",""],[875578,"University of Washington",""],[1192639,"Colgate University",""],[1309599,"University of California--Los Angeles",""],[605212,"University of Washington",""],[866817,"Ithaca College",""],[1046226,"University of Virginia",""],[805663,"Stanford University",""],[799561,"University of California--Berkeley",""],[678434,"",""],[874766,"Princeton University",""],[1307208,"University of Washington",""],[607135,"San Jose State University",""],[1192642,"University of California--Berkeley",""],[1335714,"",""],[1206058,"Brown University",""],[1277057,"Cornell University",""],[743946,"Princeton University",""],[879569,"Penn State Lehigh Valley",""],[1062192,"Hakuoh University",""],[1177306,"Colorado State University",""],[279515,"University of Alaska--Fairbanks",""],[1185504,"Ashland University",""],[1295290,"Virginia Tech",""],[652730,"University of Nottingham",""],[1268436,"University of California--Berkeley",""],[987059,"",""],[1268447,"St. Cloud State University",""],[1269245,"University of Louisville",""],[1185585,"University of New Mexico",""],[1185586,"University of Wisconsin--Milwaukee",""],[1185587,"University of California--Los Angeles",""],[1269262,"Eastern Illinois University",""],[1268479,"Dartmouth College",""],[987057,"",""],[1192635,"University of Virginia",""],[806012,"Pennsylvania State University--University Park",""],[1184972,"Stanford University",""],[1322076,"Fairmont State University",""],[1304189,"Lindenwood University",""],[1185698,"University of South Carolina",""],[1125580,"Stanford University",""],[911494,"University of Oregon",""],[961365,"University of Southern California",""],[561046,"University of Michigan--Ann Arbor",""],[618596,"Boston College",""],[788835,"San Diego Mesa College",""],[717022,"Georgetown University",""],[554744,"University of Southern Maine",""],[1135657,"Stanford University",""],[1218314,"Yale University",""],[1240178,"Brown University",""],[864191,"Stanford University",""],[588460,"University of South Florida--St. Petersburg",""],[1218384,"College of Charleston",""],[957262,"Harvard University",""],[1181820,"",""],[677951,"Yale University",""],[721816,"Oklahoma Baptist University",""],[1185911,"",""],[1313734,"United States Air Force Academy",""],[279698,"",""],[717144,"",""],[728989,"University of Colorado--Colorado Springs",""],[312776,"Auburn University",""],[1186117,"Arizona State University",""],[591504,"",""],[622936,"",""],[1335727,"",""],[1313827,"North Carolina State University--Raleigh",""],[1186108,"St. Mary's College",""],[1490164,"Ohio State University--Columbus",""],[622489,"University of Wisconsin--Oshkosh",""],[969197,"Lindenwood University",""],[732965,"Texas Christian University",""],[584333,"Troy University",""],[1416417,"West Virginia University",""],[942929,"",""],[1300392,"University of California--Berkeley",""],[671493,"University of Georgia",""],[565916,"University of Southern California",""],[291706,"University of California--Berkeley",""],[1208850,"Indiana University--Bloomington",""],[1184868,"University of Florida",""],[761985,"Texas A&M University--College Station",""],[961897,"University of Georgia",""],[1089162,"",""],[1046138,"University of Texas--Austin",""],[1184856,"Indiana University--Bloomington",""],[1046669,"University of Michigan--Ann Arbor",""],[953472,"University of Florida",""],[344051,"University of California--Berkeley",""],[591495,"University of Minnesota--Twin Cities",""],[623564,"University of Florida",""],[961697,"University of Georgia",""],[961775,"University of Texas--Austin",""],[917997,"University of California--Berkeley",""],[1208917,"University of Georgia",""],[1021034,"University of Texas--Austin",""],[1086390,"Northwestern University",""],[703239,"",""],[918020,"University of California--Berkeley",""],[1184936,"University of California--Berkeley",""],[1046885,"Stanford University",""],[1184882,"Columbia University",""],[1177855,"University of Louisville",""],[918997,"University of Arizona",""],[1045537,"University of Virginia",""],[763127,"Stanford University",""],[1186353,"Indiana University--Bloomington",""],[767784,"Schenectady County Community College",""],[1124263,"University of Georgia",""],[294749,"University of Michigan--Ann Arbor",""],[820127,"University of California--Berkeley",""],[1177852,"University of Tennessee",""],[726153,"University of California--Berkeley",""],[961958,"University of Georgia",""],[1410076,"North Carolina State University--Raleigh",""],[565913,"University of Florida",""],[961968,"University of California--Berkeley",""],[961911,"Stanford University",""],[1067278,"University of California--Berkeley",""],[1300743,"University of Texas--Austin",""],[1296613,"United States Performance Academy",""],[746032,"Stanford University",""],[804740,"Northwestern Polytechnic University",""],[1012430,"",""],[778086,"University of California--Berkeley",""],[828468,"",""],[924220,"",""],[1256659,"",""],[898850,"Southern Methodist University",""],[752505,"Miami Dade College",""],[559328,"California Lutheran University",""],[286010,"",""],[349798,"",""],[443763,"Belmont University",""],[622742,"",""],[859962,"",""],[870433,"",""],[773894,"",""],[326132,"University of Illinois--Urbana-Champaign",""],[136450,"",""],[772681,"",""],[874646,"University of Southern California",""],[136449,"",""],[1072105,"University of Arizona",""],[1325399,"University of North Carolina--Greensboro",""],[864024,"University of Wisconsin--Madison",""],[926539,"Boston College",""],[1153201,"Syracuse University",""],[607215,"Middlebury College",""],[1120795,"Pennsylvania State University--University Park",""],[886540,"Pennsylvania State University--University Park",""],[980736,"Rutgers","the State University of New Jersey--New Brunswick"],[845250,"Pennsylvania State University--University Park",""],[666724,"University of Washington",""],[685334,"California State University--Long Beach",""],[802034,"University of California--Berkeley",""],[805085,"Stanford University",""],[685406,"Stanford University",""],[845249,"University of Nebraska--Lincoln",""],[1391588,"University of California--Los Angeles",""],[1045536,"Stanford University",""],[980739,"University of Nebraska--Lincoln",""],[1119810,"University of Florida",""],[1287688,"",""],[447459,"La Salle University",""],[802027,"Pennsylvania State University--University Park",""],[1240192,"Florida Atlantic University",""],[570943,"University of Central Florida",""],[805170,"University of Southern California",""],[1121145,"University of Texas--Austin",""],[961390,"Brigham Young University--Provo",""],[1209503,"Loyola University Chicago",""],[790607,"",""],[1178060,"Stanford University",""],[1178408,"University of the Pacific",""],[1381883,"University of California--Los Angeles",""],[1309524,"",""],[1205830,"Princeton University",""],[874433,"University of Washington",""],[1178409,"Stanford University",""],[931666,"Northern Michigan University",""],[883825,"University of California--Los Angeles",""],[467848,"Pepperdine University",""],[658460,"University of California--Berkeley",""],[805683,"University of California--Los Angeles",""],[1274955,"University of Southern California",""],[658466,"University of Southern California",""],[805653,"Stanford University",""],[1205174,"University of California--Berkeley",""],[1067707,"University of Oregon",""],[1205868,"Stanford University",""],[854750,"University of Michigan--Ann Arbor",""],[1205192,"University of Southern California",""],[883826,"Stanford University",""],[381971,"Pepperdine University",""],[978025,"University of California--Los Angeles",""],[1073785,"University of Washington",""],[1301335,"University of Southern California",""],[353825,"Stanford University",""],[1043052,"University of Colorado--Colorado Springs",""],[649454,"Louisiana State University--Shreveport",""],[1223525,"Notre Dame de Namur University",""],[737928,"University of Alabama",""],[751185,"University of Colorado--Colorado Springs",""],[701388,"Drexel University",""],[555134,"Yale University",""],[1292473,"Pennsylvania State University--University Park",""],[1091282,"King University",""],[750872,"Simon Fraser University",""],[1495178,"University of Missouri",""],[970448,"University of Nebraska--Lincoln",""],[1204129,"Ohio State University--Columbus",""],[812439,"University of Nebraska--Kearney",""],[463538,"Loyola Marymount University",""],[924296,"",""],[1091405,"University of Wisconsin--Madison",""],[1217621,"",""]];function loadKaResultWidget(tSelector){var tSuffix=getRandomSuffix();buildScaffolding(RESULTS_MODE,tSelector,'Results',tSuffix);getDataFromApiAndBuild(RESULTS_MODE,tSuffix)}
function loadKaLeaderboardWidget(tSelector){var tSuffix=getRandomSuffix();buildScaffolding(LEADER_MODE,tSelector,'School Leaderboard',tSuffix);getDataFromApiAndBuild(LEADER_MODE,tSuffix)}
function getDataFromApiAndBuild(tMode,tSuffix){var asyncCalls=[];var all_ids=Array.from(getAllAthleteIdsAndSchools());for(var i=0;i<all_ids.length;i++){asyncCalls.push(singleApiCall(tMode==RESULTS_MODE?parseForResults:parseForLeader,all_ids[i]))}
$.when.apply(this,asyncCalls).done(function(){console.log("all API requests have completed");buildAll(tMode,tSuffix)})}
function buildAll(tMode,tSuffix){cleanData();var tSchools=Array.from(kaAllSchools).sort();buildFilterSelectMenu('school',tSchools,tSuffix);if(tMode==RESULTS_MODE){var tDates=Array.from(Object.keys(kaAllResultsByDate).sort(compareDateStrings));buildFilterSelectMenu('date',tDates,tSuffix);var tSports=Array.from(kaAllSports).sort();buildFilterSelectMenu('sport',tSports,tSuffix);buildFilterTextMenu('athlete',tSuffix);buildFilterSelectMenu('gender',['Men','Women','Mixed','Open'],tSuffix);buildResultsTable(tSuffix)}
else if(tMode==LEADER_MODE){buildLeaderboardTable(tSuffix)}}
function cleanData(){delete kaAllResultsBySchool[EMPTY_SCHOOL_STR];delete kaAllResultsBySchool[""];kaAllSchools.delete("")}
function singleApiCall(parser,athlete_dict){return $.ajax({url:BASE_API_URL,type:"get",data:{personId:athlete_dict.id,season:2016,languageCode:2,competitionSetId:1},dataType:"json",success:function(data){parser(data,athlete_dict)},error:function(e){console.error("Error retrieving data for "+personId)}})}
function parseForLeader(result,athlete_dict){var person=result.Person;var full_name=person.c_Sort;var sports=result.SportList;for(var i=0;i<sports.length;i++){var epml=sports[i].EventPhaseMatchList;var sport=sports[i].Sport;for(var j=0;j<epml.length;j++){var phase=epml[j];var start=phase.DateTimes.Start.c_UTC;var date=new Date(Date.parse(start));var sport_name=sport.c_Name;var genderName=phase.GenderEvent.c_Name?phase.GenderEvent.c_Name:phase.Gender.c_Name+"'s";var cat=genderName+" "+sport_name;var school1=athlete_dict.schools[0];var school2=athlete_dict.schools[1];var tMedals=phase.MedalWon;date=date.toDateString();var tMedalRow={'full_name':full_name,'sport_name':sport_name,'event_name':phase.Event.c_Name,'medal':parseMedalsByAthlete(tMedals),}
if(!(school1 in kaAllResultsBySchool)){kaAllResultsBySchool[school1]={'total':0,[GOLD_COL]:0,[SILV_COL]:0,[BROZ_COL]:0,'rows':new Set()}}
if(!(school2 in kaAllResultsBySchool)){kaAllResultsBySchool[school2]={'total':0,[GOLD_COL]:0,[SILV_COL]:0,[BROZ_COL]:0,'rows':new Set()}}
if(tMedals[GOLD_COL]){kaAllResultsBySchool[school1][GOLD_COL]++;kaAllResultsBySchool[school1].total++;kaAllResultsBySchool[school1].rows.add(tMedalRow);kaAllResultsBySchool[school2][GOLD_COL]++;kaAllResultsBySchool[school2].total++;kaAllResultsBySchool[school2].rows.add(tMedalRow)}
if(tMedals[SILV_COL]){kaAllResultsBySchool[school1][SILV_COL]++;kaAllResultsBySchool[school1].total++;kaAllResultsBySchool[school1].rows.add(tMedalRow);kaAllResultsBySchool[school2][SILV_COL]++;kaAllResultsBySchool[school2].total++;kaAllResultsBySchool[school2].rows.add(tMedalRow)}
if(tMedals[BROZ_COL]){kaAllResultsBySchool[school1][BROZ_COL]++;kaAllResultsBySchool[school1].total++;kaAllResultsBySchool[school1].rows.add(tMedalRow);kaAllResultsBySchool[school2][BROZ_COL]++;kaAllResultsBySchool[school2].total++;kaAllResultsBySchool[school2].rows.add(tMedalRow)}
kaAllSports.add(sport_name);kaAllSchools.add(school1);kaAllSchools.add(school2)}}}
function parseForResults(result,athlete_dict){var person=result.Person;var full_name=person.c_Sort;var sports=result.SportList;for(var i=0;i<sports.length;i++){var epml=sports[i].EventPhaseMatchList;var sport=sports[i].Sport;for(var j=0;j<epml.length;j++){var phase=epml[j];var start=phase.DateTimes.Start.c_UTC;var date=new Date(Date.parse(start));var sport_name=sport.c_Name;var genderName=phase.GenderEvent.c_Name?phase.GenderEvent.c_Name:phase.Gender.c_Name+"'s";var cat=genderName+" "+sport_name;var school1=athlete_dict.schools[0];var school2=athlete_dict.schools[1];var tMedals=phase.MedalWon;date=date.toDateString();if(!(date in kaAllResultsByDate)){kaAllResultsByDate[date]={}}
if(!(cat in kaAllResultsByDate[date])){kaAllResultsByDate[date][cat]=[]}
var tRow={'full_name':full_name,'gender':phase.Gender.c_Name,'event_name':phase.Event.c_Name,'event':phase.c_Phase,'start':start,'end':phase.DateTimes.End.c_UTC,'medal':parseMedalsByAthlete(tMedals),'finished':phase.b_Finished,'result':phase.c_ResultPhase,'place':phase.n_RankPhase,'sport_name':sport_name,'schools':athlete_dict.schools};kaAllResultsByDate[date][cat]=kaAllResultsByDate[date][cat].concat(tRow);kaAllSports.add(sport_name);kaAllSchools.add(school1);kaAllSchools.add(school2)}}}
function parseMedalsByAthlete(tMedals){var tMedalStr="--";tMedalStr=tMedals[GOLD_COL]?"Gold":tMedalStr;tMedalStr=tMedals[SILV_COL]?"Silver":tMedalStr;tMedalStr=tMedals[BROZ_COL]?"Bronze":tMedalStr;return tMedalStr}
function getAllAthleteIds(){ids=new Set();for(var i=0;i<athlete_lookup.length;i++){ids.add(athlete_lookup[i][ATHLETE_ID_COL])}
ids.delete("");return ids}
function getAllAthleteIdsAndSchools(){ids=new Set();for(var i=0;i<athlete_lookup.length;i++){ids.add({'id':athlete_lookup[i][ATHLETE_ID_COL],'schools':[athlete_lookup[i][SCHOOL_1_COL]||EMPTY_SCHOOL_STR,athlete_lookup[i][SCHOOL_2_COL]]})}
ids.delete("");return ids}
function buildResultsTable(tSuffix){var tLoading=$(`#ka-load-div-${tSuffix}`);var tTable=$(`#ka-table-${tSuffix}`);var tBody=$(`<tbody class="ka-outer-table-body"/>`);var dates=Object.keys(kaAllResultsByDate).sort(compareDateStrings);for(var j=0;j<dates.length;j++){var tDayResults=kaAllResultsByDate[dates[j]];var tTarget=`date-row-${dates[j].replace(/ /g,'')}-${tSuffix}`;var tDateSection=buildDateSection(dates[j],tDayResults,tTarget,tSuffix);tBody.append(tDateSection)}
tLoading.remove();tTable.append(tBody)}
function buildLeaderboardTable(tSuffix){var tSortedResults=sortSchoolResults(kaAllResultsBySchool);var tLoading=$(`#ka-load-div-${tSuffix}`);var tTable=$(`#ka-table-${tSuffix}`);var tBody=$(`<tbody class="ka-outer-table-body"/>`);var tRh=buildHeader(['School','Total Medals','Gold','Silver','Bronze']);tRh.addClass('ka-inner-thead');tBody.append(tRh);for(var j=0;j<tSortedResults.length;j++){var tSchool=tSortedResults[j][0];var tResult=tSortedResults[j][1];var toggleID="ka-toggle-"+j;var tRow=$(`<tr data-toggle="collapse" data-target="#${toggleID}" class="ka-medal-row accordion-toggle" />`);tRow.append($(`<td align='left'/>`).html(schoolCleaner(tSchool)));tRow.append($(`<td/>`).html(tResult.total));tRow.append($(`<td/>`).html(tResult[GOLD_COL]));tRow.append($(`<td/>`).html(tResult[SILV_COL]));tRow.append($(`<td/>`).html(tResult[BROZ_COL]));tRow.attr(`ka-filter-school-${tSuffix}`,tSchool);var tHiddenSection=buildHiddenContent(toggleID,tResult);tHiddenSection.attr(`ka-filter-school-${tSuffix}`,tSchool);tBody.append(tRow);tBody.append(tHiddenSection)}
tLoading.remove();tTable.append(tBody)}
function buildHiddenContent(tId,tResult){var tResRows=Array.from(tResult.rows);var tHiddenRow=$(`<tr class="hidden-tr"/>`);var tHiddenTD=$('<td colspan="6" class="hiddenRow"/>');var tHiddenDiv=$(`<div class="accordion-body collapse" id="${tId}"/>`);var tTable=$(`<table class="ka-inner-table table table-striped table-light table-sm" style="width:100%"\>`);if(tResRows.length<1){tHiddenDiv.html('no results')}
else{tTable.append($(`<thead><tr><th>Medal</th><th>Sport</th><th>Event</th><th>Athlete</th></tr></thead>`));var tTableBody=$(`<tbody>`);for(var j=0;j<tResRows.length;j++){var tResRow=tResRows[j];var tRow=$(`<tr/>`);tRow.append($(`<td/>`).html(tResRow.medal));tRow.append($(`<td/>`).html(tResRow.sport_name));tRow.append($(`<td/>`).html(tResRow.event_name));tRow.append($(`<td/>`).html(tResRow.full_name));tTableBody.append(tRow)}
tTable.append(tTableBody)}
tHiddenDiv.append(tTable);tHiddenTD.append(tHiddenDiv);tHiddenRow.append(tHiddenTD);return tHiddenRow}
function buildHeader(fields){var tHead=$(`<thead class="ka-event-row-header"/>`);var tRh=$(`<tr/>`);for(var j=0;j<fields.length;j++){tRh.append($(`<th/>`).html(fields[j]))}
tHead.append(tRh);return tHead}
function buildDateSection(tDate,tResult,tTarget,tSuffix){var tEventNames=Object.keys(tResult);var tDateSection=$(`<tr data-toggle="collapse" ka-filter-date-${tSuffix}="${tDate}" data-target="#${tTarget}" class="ka-date-section"/>`);tDateSection.html(`<div>${tDate}</div>`);for(var j=0;j<tEventNames.length;j++){var tEventName=tEventNames[j];var tEventSection=buildEventSection(tEventName,tResult[tEventName],tSuffix);tDateSection.append(tEventSection)}
return tDateSection}
function buildEventSection(tEventName,tResults,tSuffix){var tEvent=$(`<tr class="ka-event-section"/>`);var tSportName=tResults[0].sport_name;var tIcon=icon_lookup[tSportName];tEvent.attr(`ka-filter-gender-${tSuffix}`,tResults[0].gender);tEvent.attr(`ka-filter-sport-${tSuffix}`,tSportName);var icon=`&nbsp&nbsp <img class="invert-icon" src='assets/${tIcon}' width="30" alt=""> &nbsp&nbsp`;tEvent.html(`<div>${icon}${tEventName}${icon}</div>`);var tHead=buildHeader(['Event/Round/Match','Result','Place','Medal','Athlete','School']);tEvent.append(tHead);for(var j=0;j<tResults.length;j++){tEvent.append(buildRowSection(tResults[j],tSuffix))}
return tEvent}
function buildRowSection(tRes,tSuffix){var tRow=$(`<tr class="ka-event-row"/>`);tRow.append($('<td/>').html(tRes.event));tRow.append($('<td/>').html(tRes.result));tRow.append($('<td/>').html(tRes.place));tRow.append($('<td/>').html(tRes.medal));tRow.append($('<td/>').html(tRes.full_name));tRow.append($('<td/>').html(schoolsToString(tRes.schools)));tRow.attr(`ka-filter-school-${tSuffix}`,tRes.schools[0]);if(tRes.schools[1].length){tRow.attr(`ka-filter-school2-${tSuffix}`,tRes.schools[1])}
tRow.attr(`ka-filter-athlete-${tSuffix}`,tRes.full_name.toUpperCase());return tRow}
function schoolsToString(tArr){return tArr[0]+(tArr[1].length?", "+tArr[1]:"")}
function buildScaffolding(tMode,tSelector,tTitle,tSuffix){var tWidget=$(tSelector);tWidget.append($(`<h2>${tTitle}</h2>`));tWidget.append(buildNav(tMode,tSuffix));$(`.ka-select`).selectpicker("refresh");tWidget.append(kaLoaderRing(tSuffix).append(`<table class="ka-table table w-auto 
       ${tMode == LEADER_MODE ? '':'fixed-size-table'}" 
       id="ka-table-${tSuffix}" ></table>`))}
function buildNav(tMode,tSuffix){var tNav=$(`<nav class="navbar navbar-expand-lg navbar-light bg-light" \>`);var tNavDiv=$(`<div class="collapse navbar-collapse" id="navbarSupportedContent" \>`);var tUl=$(`<ul class="navbar-nav mr-auto">`);tOpts=tMode==RESULTS_MODE?['date','sport','gender','school']:['school'];for(var j=0;j<tOpts.length;j++){var tLi=$(`<li class="nav-item dropdown" \>)`);tLi.append($(`<select class="selectpicker ka-select dropdown-primary" data-width="130px" multiple="multiple" data-actions-box="true" data-title="${capitalize(tOpts[j])}" data-selected-text-format="static" id="ka-${tOpts[j]}-dropdown-${tSuffix}" \>)`));tUl.append(tLi)}
tNavDiv.append(tUl);if(tMode==RESULTS_MODE){tNavDiv.append($(`<form class="form-inline my-2 my-lg-0" style="width:220px">
        <input style="width:100%" type="text" id="ka-athlete-text-filter-${tSuffix}" placeholder="Filter by athlete name..." title="Type in a name"></input>
        </form>`))}
tNav.append(tNavDiv);return tNav}
function buildFilterTextMenu(tKey,tSuffix){var tInput=$(`#ka-${tKey}-text-filter-${tSuffix}`);tInput.keyup(function(){var tVal=tInput.val().toUpperCase();var tAllRows=$(`tr[ka-filter-${tKey}-${tSuffix}]`);if(tVal.length){var tFilterString=`tr[ka-filter-${tKey}-${tSuffix}*='${tVal}']`;fadeIn($(tFilterString),`ka-hidden-${tKey}`);fadeOut(tAllRows.not(tFilterString),`ka-hidden-${tKey}`)}else{fadeIn(tAllRows,`ka-hidden-${tKey}`)}
hideEmptySections()})}
function buildFilterSelectMenu(tKey,tOpts,tSuffix){var tMenu=$(`#ka-${tKey}-dropdown-${tSuffix}`);for(var i=0;i<tOpts.length;i++){buildMenuCheckRow(tKey,tOpts[i],tMenu)}
tMenu.selectpicker("refresh");wireMenu(tMenu,tKey,tSuffix)}
function buildMenuCheckRow(tKey,tVal,baseElem){var tOption=$(`<option selected="selected" ka-filter-key="${tKey}" ka-filter-val="${tVal}" value="${tVal}">${tVal}</option>`);baseElem.append(tOption);return tOption}
function wireMenu(tMenu,tKey,tSuffix){tMenu.on("changed.bs.select",function(e,clickedIndex,newValue,oldValue){var tOpts=$(`#ka-${tKey}-dropdown-${tSuffix} option`);for(var i=0;i<tOpts.length;i++){var tOpt=tOpts[i];var tVal=tOpt.value;var tRow=$(`tr[ka-filter-${tKey}-${tSuffix}='${tVal}']`);var tRow2=$(`tr[ka-filter-${tKey}2-${tSuffix}='${tVal}']`);var tHidingClass=`ka-hidden-${tKey}`;if(tOpt.selected){fadeIn(tRow,tHidingClass);fadeIn(tRow2,tHidingClass)}
else{fadeOut(tRow,tHidingClass);fadeOut(tRow2,tHidingClass)}}})}
function getRandomSuffix(){return Math.random().toString(36).substring(2,7)}
function schoolCleaner(tSchool){tSchool=tSchool.replace(/--/g," ");return tSchool}
function capitalize(mystr){return mystr.charAt(0).toUpperCase()+mystr.slice(1)}
function compareDateStrings(a,b){var lhs=Date.parse(a);var rhs=Date.parse(b);return lhs>rhs?1:-1}
function sortSchoolResults(tResults){var itemsToSort=Object.keys(tResults).map(function(key){return[key,tResults[key]]});return itemsToSort.sort(function(lhs,rhs){return rhs[1].total-lhs[1].total})}
function kaLoaderRing(tSuffix){return $(`<div class='ka-table-container'>
            <div id="ka-load-div-${tSuffix}">
                <img src='assets/usflag.png' style="padding-top:75px; width:300px;">
                <div class="ka-load-div">
                    <div class="ka-loader ka-load-ring-1"></div>
                    <div class="ka-loader ka-load-ring-2"></div>
                    <div class="ka-loader ka-load-ring-3"></div>
                    <div class="ka-loader ka-load-ring-4"></div>
                    <div class="ka-loader ka-load-ring-5"></div>
                </div>
            </div>
        </div>`)}
function fadeIn(tElem,tClass){Promise.all([tElem.fadeIn("fast",function(){$(this).removeClass(tClass)}).promise()]).then(function(){hideEmptySections()})}
function fadeOut(tElem,tClass){Promise.all([tElem.fadeOut("fast",function(){$(this).addClass(tClass)}).promise()]).then(function(){hideEmptySections()})}
function hideEmptySections(){var promises=[];var allSections=$('.ka-event-section');for(var i=0;i<allSections.length;i++){var sct=$(allSections[i]);if(sct.find('tr.ka-event-row').length==sct.find('tr.ka-event-row[class*="ka-hidden-"]').length){promises=promises.concat(sct.fadeOut("fast",function(){$(this).addClass('ka-hidden-section')}).promise())}
else{promises=promises.concat(sct.fadeIn("fast",function(){$(this).removeClass('ka-hidden-section')}).promise())}}
Promise.all(promises).then(function(){hideEmptyDateSections()})}
function hideEmptyDateSections(){var allDateSections=$('.ka-date-section');for(var i=0;i<allDateSections.length;i++){var sct=$(allDateSections[i]);if(sct.find('tr.ka-event-section').length==sct.find('tr.ka-event-section[class*="ka-hidden-"]').length){sct.fadeOut("fast",function(){$(this).addClass('ka-hidden-section')})}
else{sct.fadeIn("fast",function(){$(this).removeClass('ka-hidden-section')})}}}